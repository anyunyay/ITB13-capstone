# Order ID Flow in Suspicious Order Grouping

## Visual Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATABASE (Backend)                          â”‚
â”‚                                                                     â”‚
â”‚  sales_audits table:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ id â”‚ customer_id  â”‚ status â”‚ amount   â”‚ created_at          â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚123 â”‚ john@ex.com  â”‚pending â”‚ 150.00   â”‚ 2025-11-22 10:00:00 â”‚  â”‚
â”‚  â”‚124 â”‚ john@ex.com  â”‚pending â”‚ 200.00   â”‚ 2025-11-22 10:05:00 â”‚  â”‚
â”‚  â”‚125 â”‚ john@ex.com  â”‚pending â”‚ 100.00   â”‚ 2025-11-22 10:08:00 â”‚  â”‚
â”‚  â”‚126 â”‚ jane@ex.com  â”‚pending â”‚ 300.00   â”‚ 2025-11-22 10:15:00 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  âŒ NO group_id column                                             â”‚
â”‚  âŒ NO synthetic IDs                                               â”‚
â”‚  âœ… Only original order IDs                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ OrderController::suspicious()
                                    â”‚ Fetches orders with original IDs
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND RESPONSE (JSON)                          â”‚
â”‚                                                                     â”‚
â”‚  [                                                                  â”‚
â”‚    { "id": 123, "customer": {...}, "created_at": "..." },         â”‚
â”‚    { "id": 124, "customer": {...}, "created_at": "..." },         â”‚
â”‚    { "id": 125, "customer": {...}, "created_at": "..." },         â”‚
â”‚    { "id": 126, "customer": {...}, "created_at": "..." }          â”‚
â”‚  ]                                                                  â”‚
â”‚                                                                     â”‚
â”‚  âœ… Original IDs preserved: 123, 124, 125, 126                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Inertia passes to frontend
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FRONTEND GROUPING (order-grouping.ts)                  â”‚
â”‚                                                                     â”‚
â”‚  groupSuspiciousOrders(orders, 10)                                 â”‚
â”‚                                                                     â”‚
â”‚  Input: Orders with IDs [123, 124, 125, 126]                      â”‚
â”‚                                                                     â”‚
â”‚  Logic:                                                             â”‚
â”‚  1. Sort by created_at                                             â”‚
â”‚  2. Find orders from same customer within 10 minutes               â”‚
â”‚  3. Group them logically (NO ID MODIFICATION)                      â”‚
â”‚                                                                     â”‚
â”‚  Output: OrderGroup[]                                              â”‚
â”‚  [                                                                  â”‚
â”‚    {                                                                â”‚
â”‚      type: 'suspicious',                                           â”‚
â”‚      orders: [                                                      â”‚
â”‚        { id: 123, ... },  â† Original ID                           â”‚
â”‚        { id: 124, ... },  â† Original ID                           â”‚
â”‚        { id: 125, ... }   â† Original ID                           â”‚
â”‚      ],                                                             â”‚
â”‚      isSuspicious: true,                                           â”‚
â”‚      minutesDiff: 8                                                â”‚
â”‚    },                                                               â”‚
â”‚    {                                                                â”‚
â”‚      type: 'single',                                               â”‚
â”‚      orders: [{ id: 126, ... }],  â† Original ID                   â”‚
â”‚      isSuspicious: false                                           â”‚
â”‚    }                                                                â”‚
â”‚  ]                                                                  â”‚
â”‚                                                                     â”‚
â”‚  âŒ NO synthetic group IDs created                                 â”‚
â”‚  âœ… Original order IDs preserved: 123, 124, 125, 126              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Pass to components
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DISPLAY (React Components)                       â”‚
â”‚                                                                     â”‚
â”‚  Main Orders Page (/admin/orders):                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸš¨ Alert: Suspicious patterns detected                    â”‚    â”‚
â”‚  â”‚    [View Suspicious Orders] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                       â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Order #126 - Jane Doe                             â”‚       â”‚    â”‚
â”‚  â”‚ Status: Pending | â‚±300.00                         â”‚       â”‚    â”‚
â”‚  â”‚ [View Details] â†’ /admin/orders/126 â† Original ID  â”‚       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚                                                               â”‚    â”‚
â”‚  Suspicious Orders Page (/admin/orders/suspicious): â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ âš ï¸ SUSPICIOUS ORDER GROUP                                â”‚    â”‚
â”‚  â”‚ 3 Orders from Same Customer                               â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Order #123 - â‚±150.00  â† Original ID                      â”‚    â”‚
â”‚  â”‚ [View Details] â†’ /admin/orders/123                        â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚ Order #124 - â‚±200.00  â† Original ID                      â”‚    â”‚
â”‚  â”‚ [View Details] â†’ /admin/orders/124                        â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚ Order #125 - â‚±100.00  â† Original ID                      â”‚    â”‚
â”‚  â”‚ [View Details] â†’ /admin/orders/125                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  React Key: "group-123-124-125" (composite of original IDs)       â”‚
â”‚  âœ… All links use original IDs                                     â”‚
â”‚  âœ… All displays show original IDs                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ User clicks "Approve All"
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER ACTION (Group Verdict)                      â”‚
â”‚                                                                     â”‚
â”‚  JavaScript extracts original IDs:                                 â”‚
â”‚  const orderIds = group.orders.map(o => o.id);                    â”‚
â”‚  // Result: [123, 124, 125]                                        â”‚
â”‚                                                                     â”‚
â”‚  POST /admin/orders/group-verdict                                  â”‚
â”‚  {                                                                  â”‚
â”‚    "order_ids": [123, 124, 125],  â† Original IDs                  â”‚
â”‚    "verdict": "approve",                                           â”‚
â”‚    "admin_notes": "Bulk approve - Suspicious order group"         â”‚
â”‚  }                                                                  â”‚
â”‚                                                                     â”‚
â”‚  âœ… Only original IDs sent to backend                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Backend processes request
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BACKEND PROCESSING (GroupVerdictController)            â”‚
â”‚                                                                     â”‚
â”‚  foreach ([123, 124, 125] as $orderId) {                          â”‚
â”‚      $order = SalesAudit::find($orderId);  â† Uses original ID     â”‚
â”‚      $order->update(['status' => 'approved']);                     â”‚
â”‚  }                                                                  â”‚
â”‚                                                                     â”‚
â”‚  âœ… Processes using original IDs                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Update database
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE UPDATED (Backend)                       â”‚
â”‚                                                                     â”‚
â”‚  sales_audits table:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ id â”‚ customer_id  â”‚ status   â”‚ amount   â”‚ created_at       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚123 â”‚ john@ex.com  â”‚approved  â”‚ 150.00   â”‚ 2025-11-22 10:00 â”‚   â”‚
â”‚  â”‚124 â”‚ john@ex.com  â”‚approved  â”‚ 200.00   â”‚ 2025-11-22 10:05 â”‚   â”‚
â”‚  â”‚125 â”‚ john@ex.com  â”‚approved  â”‚ 100.00   â”‚ 2025-11-22 10:08 â”‚   â”‚
â”‚  â”‚126 â”‚ jane@ex.com  â”‚pending   â”‚ 300.00   â”‚ 2025-11-22 10:15 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  âœ… Original IDs unchanged: 123, 124, 125, 126                     â”‚
â”‚  âœ… Status updated using original IDs                              â”‚
â”‚  âŒ NO synthetic IDs stored                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Takeaways

### ğŸ”‘ Original IDs Flow Through Entire System

```
Database (123, 124, 125)
    â†“
Backend Response (123, 124, 125)
    â†“
Frontend Grouping (123, 124, 125)
    â†“
Display (Order #123, #124, #125)
    â†“
User Action ([123, 124, 125])
    â†“
Backend Processing (123, 124, 125)
    â†“
Database Update (123, 124, 125)
```

### âœ… What Happens
- Orders keep their original IDs at every step
- Grouping is purely logical (display-only)
- All operations use original IDs
- Database remains unchanged

### âŒ What Does NOT Happen
- No synthetic group IDs created
- No new order records generated
- No ID modification or transformation
- No database schema changes

---

**Conclusion**: The system correctly preserves original order IDs throughout the entire flow, from database to display to backend operations. Grouping is purely a frontend presentation concern and does not affect order identifiers in any way.
